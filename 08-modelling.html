<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Practical Guide to Health Data Science in Aotearoa New Zealand - 8&nbsp; Modelling</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./09-evaluation.html" rel="next">
<link href="./07-data-preparation.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


</head>

<body class="nav-sidebar floating slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Modelling</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Practical Guide to Health Data Science in Aotearoa New Zealand</a> 
        <div class="sidebar-tools-main">
    <a href="" title="Download" id="sidebar-tool-dropdown-0" class="sidebar-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi bi-download"></i></a>
    <ul class="dropdown-menu" aria-labelledby="sidebar-tool-dropdown-0">
        <li>
          <a class="dropdown-item sidebar-tools-main-item" href="./Practical-Guide-to-Health-Data-Science-in-Aotearoa-New-Zealand.pdf">
            <i class="bi bi-bi-file-pdf pe-1"></i>
          Download PDF
          </a>
        </li>
        <li>
          <a class="dropdown-item sidebar-tools-main-item" href="./Practical-Guide-to-Health-Data-Science-in-Aotearoa-New-Zealand.epub">
            <i class="bi bi-bi-journal pe-1"></i>
          Download ePub
          </a>
        </li>
    </ul>
    <a href="" title="Share" id="sidebar-tool-dropdown-1" class="sidebar-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi bi-share"></i></a>
    <ul class="dropdown-menu" aria-labelledby="sidebar-tool-dropdown-1">
        <li>
          <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=|url|">
            <i class="bi bi-bi-twitter pe-1"></i>
          Twitter
          </a>
        </li>
        <li>
          <a class="dropdown-item sidebar-tools-main-item" href="https://www.linkedin.com/sharing/share-offsite/?url=|url|">
            <i class="bi bi-bi-linkedin pe-1"></i>
          LinkedIn
          </a>
        </li>
    </ul>
</div>
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Welcome</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-intro.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-starting.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">How do I start?</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-basics.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Understanding the basics</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-collaboration.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">People, capability &amp; collaboration</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-data-landscape.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">The unique health data landscape</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-data-identifiability.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Data Identifiability</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-data-preparation.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Data preparation</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-modelling.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Modelling</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-evaluation.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Evaluation</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-deployment-lifecycle.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Deployment &amp; Lifecycle Maintenance</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-references.html" class="sidebar-item-text sidebar-link">Useful references and templates</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#modelling-process" id="toc-modelling-process" class="nav-link active" data-scroll-target="#modelling-process"><span class="toc-section-number">8.1</span>  Modelling process</a></li>
  <li><a href="#modelling-approaches" id="toc-modelling-approaches" class="nav-link" data-scroll-target="#modelling-approaches"><span class="toc-section-number">8.2</span>  Modelling approaches</a></li>
  <li><a href="#documentation-and-management" id="toc-documentation-and-management" class="nav-link" data-scroll-target="#documentation-and-management"><span class="toc-section-number">8.3</span>  Documentation and management</a></li>
  <li><a href="#modelling-tools" id="toc-modelling-tools" class="nav-link" data-scroll-target="#modelling-tools"><span class="toc-section-number">8.4</span>  Modelling tools</a></li>
  <li><a href="#experiment-tracking-tools" id="toc-experiment-tracking-tools" class="nav-link" data-scroll-target="#experiment-tracking-tools"><span class="toc-section-number">8.5</span>  Experiment tracking tools</a></li>
  <li><a href="#model-validation" id="toc-model-validation" class="nav-link" data-scroll-target="#model-validation"><span class="toc-section-number">8.6</span>  Model validation</a>
  <ul class="collapse">
  <li><a href="#data-partitioning" id="toc-data-partitioning" class="nav-link" data-scroll-target="#data-partitioning"><span class="toc-section-number">8.6.1</span>  Data partitioning</a></li>
  <li><a href="#performance-metrics" id="toc-performance-metrics" class="nav-link" data-scroll-target="#performance-metrics"><span class="toc-section-number">8.6.2</span>  Performance metrics</a></li>
  </ul></li>
  <li><a href="#further-resources" id="toc-further-resources" class="nav-link" data-scroll-target="#further-resources"><span class="toc-section-number">8.7</span>  Further resources</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Modelling</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>We use the word “modelling” broadly, to capture the process of analysis involved in data science. In this guide, a model is a simplified quantitative representation of a real world situation, often to answer a specific question. Modelling can be used as a tool to help derive insights or drive decision making. In other industries, life experience is often enough to guide you. However, in a health context domain expertise is extremely important e.g.&nbsp;what defines a hospitalisation?</p>
<p>This guidance should be applicable to any analytical technique.</p>
<section id="modelling-process" class="level2" data-number="8.1">
<h2 data-number="8.1" class="anchored" data-anchor-id="modelling-process"><span class="header-section-number">8.1</span> Modelling process</h2>
<p>Although the details can be different case by case, there are several general steps and a few principles that may help to achieve good results.</p>
<p><a href="img/modelling-diagram.png" data-fig-alt="A flowchart of the modelling process">Modelling process overview</a> Adapted from W. Hare, A. R. Rutherford, K. Vasarhelyi and The Complex Systems Modelling Group: Modelling in Healthcare, American Mathematical Society (2010)</p>
<p>Scoping should clearly define what problem a model is intended to solve. This affects almost all the later steps. In general, a more specific scope is more likely to lead to success, which should also be defined at the outset. Documenting the scope usually involves sign-off from oversight groups, and can reduce wasted effort or misunderstanding.</p>
</section>
<section id="modelling-approaches" class="level2" data-number="8.2">
<h2 data-number="8.2" class="anchored" data-anchor-id="modelling-approaches"><span class="header-section-number">8.2</span> Modelling approaches</h2>
<p>One general principle of modelling design is to select models that are as simple as possible while capable of providing solutions to the defined problem.</p>
<p>There are often multiple modelling approaches suitable for solving one problem, and each has advantages and disadvantages. If capacity and feasibility allow, it is often beneficial to utilise more than one technique - similar insights provided via different approaches add to the credibility of modelling.</p>
<p>The choice of technique is influenced by your ability to be able to explain how it works to end users and operationalise the inputs to the model. Consider this prior to choosing which model is used.</p>
<p>A non-exhaustive list of categories of quantitative models and the example healthcare problems that they are used for:</p>
<table class="table">
<colgroup>
<col style="width: 28%">
<col style="width: 72%">
</colgroup>
<thead>
<tr class="header">
<th>Model</th>
<th>Example use case</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Descriptive statistics</td>
<td>Understand disease prevalence and demographics of patient cohorts</td>
</tr>
<tr class="even">
<td>Regression model</td>
<td>Relationship between risk factors vs.&nbsp;cost of cancer treatment</td>
</tr>
<tr class="odd">
<td>Classification model</td>
<td>Identify high risk patients</td>
</tr>
<tr class="even">
<td>Clustering model</td>
<td>Identify different patient cohorts</td>
</tr>
<tr class="odd">
<td>Simulations</td>
<td>Workforce planning during a pandemic using simulated disease spread trend</td>
</tr>
<tr class="even">
<td>Optimisation</td>
<td>Minimising surgeons’ overtime while planning as effectively as possible to meet surgery demands</td>
</tr>
<tr class="odd">
<td>System dynamics</td>
<td>GP training plan for the next ten years given the population and workforce dynamics</td>
</tr>
<tr class="even">
<td>Language models</td>
<td>Model-aided auto coding of clinical documents</td>
</tr>
</tbody>
</table>
<p>For more models in healthcare, please refer to W. Hare, A. R. Rutherford, K. Vasarhelyi and The Complex Systems Modelling Group: Modelling in Healthcare, American Mathematical Society (2010).</p>
</section>
<section id="documentation-and-management" class="level2" data-number="8.3">
<h2 data-number="8.3" class="anchored" data-anchor-id="documentation-and-management"><span class="header-section-number">8.3</span> Documentation and management</h2>
<p>Documenting all the steps and experiments is highly recommended. Specific information about the software used in model development and the modelling environment itself should be comprehensively documented, including the language or software used, dependencies, and version numbers, to enable the model to be able to be reproduced. Frequently a package is updated and causes a change that affects the production, performance, or other aspects of a model.</p>
<p>For machine learning model management, there are open-source tools such as <a href="https://mlflow.org/">MLflow</a> to efficiently manage the ML lifecycle, including experimentation, reproducibility, deployment, and a central model registry. Tools including <strong>pipenv/renv</strong> assist portability and reproducibility, and help generate this documentation.</p>
<p>Providing an explicit statement of model assumptions to analysts or end users e.g.&nbsp;input parameter values chosen, uncertainty in those values, deterministic vs stochastic modelling, sensitivity analyses.</p>
<p>Use of a version control system such as <strong>git</strong> is very important for coordinating collaboration, avoiding rework, auditing, and generally maintaining your own sanity.</p>
</section>
<section id="modelling-tools" class="level2" data-number="8.4">
<h2 data-number="8.4" class="anchored" data-anchor-id="modelling-tools"><span class="header-section-number">8.4</span> Modelling tools</h2>
<p>Commonly used tools for statistical analysis and modelling that require minimum programming:</p>
<ul>
<li><p>Statistical Package for the Social Sciences (SPSS). Suitable for descriptive statistics, parametric and non-parametric analyses, and visualisation of analysis results.</p></li>
<li><p>Microsoft Excel. Easy to have some initial observation over tabular data, suitable to generate summary metrics of data, and create simple data visualisations. Excel has some notable drawbacks including:</p></li>
<li><p>A limitation for showing up to 1,048,576 rows by 16,384 columns in a worksheet</p></li>
<li><p>As an artefact, it is difficult to audit and rerun with different data</p></li>
<li><p>The data and analytics layers are entangled, which can compromise data integrity.</p></li>
<li><p>Cloud based modelling platforms such as BigML (<a href="https://bigml.com/">https://bigml.com/</a>). These platforms provide a web interface for users to easily run machine learning modelling experiments as well as interpretability and collaborative features. However, users may need to upload their data to the cloud, which may require additional data policy checking for the use case.</p></li>
</ul>
<p>Commonly used programming tools for statistical analysis and modelling:</p>
<ul>
<li><p>R. R is a fully open-source software environment for statistical computing and graphics. R has a GUI Rstudio, where R markdown can be a plug-in to facilitate R code and markdown based report/documentation generation and thus collaboration. The R community is active in developing and maintaining various analysing and modelling packages. Essential packages for data science includes:</p>
<ul>
<li><p>For data manipulation: dplyr, tidyr, dbplyr</p></li>
<li><p>For modelling: caret, e1071, mlr3</p></li>
<li><p>For visualisation: ggplot2, plotly</p></li>
<li><p>For report generation: knitr</p></li>
<li><p>For creating interactive web interface: shiny</p></li>
</ul></li>
<li><p>Python. Python is a high-level object-oriented programming language with good code readability. Python has a comprehensive ecosystem to support common statistical analysis, machine learning, deep learning and the implementation and deployment of these data science features. Jupyter notebook/lab is a widely used tool in the Python ecosystem for shareable data science work. Many dependencies in the Python ecosystem are open-source. Essential python dependencies for data science include:</p>
<ul>
<li><p>For data manipulation: pandas, numpy</p></li>
<li><p>For statistical analysis: scipy, statsmodels</p></li>
<li><p>For modelling including machine learning: scikit-learn, statsmodels</p></li>
<li><p>For deep learning: tensorflow, pytorch, keras</p></li>
<li><p>For visualisation: matplotlib, seaborn, plotly, bokeh</p></li>
<li><p>For creating interactive web interface: dash, streamlit</p></li>
</ul></li>
<li><p>SAS. SAS is a statistical software suite for data management, advanced analytics, multivariate analysis, predictive analytics and so on. SAS has its own GUI for non-technical users but programming via the SAS language can provide more flexibility and functionality in the analysis. It provides free SAS Ondemand for Academics (previous University Edition) for non commercial users such as students and educators.</p></li>
<li><p>Matlab. Matlab is a programming language and environment optimised for numeric computing. Especially for matrix manipulation, Matlab has advantages compared with the aforementioned other tools. For machine learning and deep learning, Matlab provides the Statistics and Machine Learning Toolbox and the Deep Learning Toolbox, respectively.</p></li>
</ul>
<p>Open source tools such as R and python provide transparency, collaboration and a low barrier to entry. Commercial tools tend to have a more sophisticated user experience, but a limited ecosystem, and provide some assurances (e.g.&nbsp;extension/library support) that aren’t available through commercial partners.</p>
</section>
<section id="experiment-tracking-tools" class="level2" data-number="8.5">
<h2 data-number="8.5" class="anchored" data-anchor-id="experiment-tracking-tools"><span class="header-section-number">8.5</span> Experiment tracking tools</h2>
<p>The process of developing a model is iterative, potentially involving trial and error for experiment configuration tuning, training and evaluation of the model. When the complexity of a model grows, monitoring experiment configurations and model performance could become a hassle. Using automatic experiment tracking tools such as Tensorboard, weights &amp; biases are helpful to overcome those issues. In general, experiment tracking tools provide features such as visualisation, logging, integration with multiple ML frameworks and model profiling. Also, such tools provide integration facilities for CI/CD pipelines, ML lifecycle management tools which helps to streamline the model training and deployment pipeline while keeping traces in the experiment lifecycle.</p>
<p>There are lists online which suggest experiment tracking tools for machine learning <a href="https://neptune.ai/blog/best-ml-experiment-tracking-tools">note an example list</a>.</p>
</section>
<section id="model-validation" class="level2 page-columns page-full" data-number="8.6">
<h2 data-number="8.6" class="anchored" data-anchor-id="model-validation"><span class="header-section-number">8.6</span> Model validation</h2>
<section id="data-partitioning" class="level3 page-columns page-full" data-number="8.6.1">
<h3 data-number="8.6.1" class="anchored" data-anchor-id="data-partitioning"><span class="header-section-number">8.6.1</span> Data partitioning</h3>
<p>Models are usually tuned to the dataset that they are trained with. Using independent datasets for validating the performance of a model is preferred. However, in the healthcare domain, data sharing can make this difficult.</p>
<p>Where independent datasets are not available, the model needs to be validated using the development dataset. There are two main approaches for train-test data splitting and model validation.[^1]</p>
<ol type="1">
<li>Cross validation</li>
</ol>
<p>This method mixes and shuffles all the data points and splits them into k folds (usually 5-10) for iterative performance measuring. In each iteration, one fold is left out as the testing set and the others are used as the training set. By these iterations, k measures of the chosen performance metric(s) could be obtained to assess the model’s average performance and its variance, which is used as an estimate of the model’s performance on unseen data.</p>
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><a href="http://ethen8181.github.io/machine-learning/model_selection/img/kfolds.png"><img src="./img/kfolds.png" class="img-fluid figure-img" alt="Example of k-fold cross validation"></a></p>
<p></p><figcaption class="figure-caption margin-caption">Example of K-Fold Cross Validation when k=5</figcaption><p></p>
</figure>
</div>
<p>To use this method, it is important to make sure that there are no significant data changes along the time within the model development dataset, and no foreseeable data changes between the development set and the future data that the model would be applied on.</p>
<p>In healthcare, it is also important to check whether the model will be used at an event level or patient level in advance.</p>
<p>There could be multiple events for the same patient in a dataset and if no proper consideration is taken into account while splitting the testing data (or other preprocessing like deduplication), this could potentially lead to information leakage and inaccuracy.</p>
<p>For example, in a longitudinal dataset of health encounters, the dataset could be split to group all of a patient’s encounters together (so these are not split across sets), or split by time (which could mean a patient’s encounters are split between different validation sets). Consider whether these types of splitting will make a meaningful difference to your validation exercises. Also be mindful of anything that involves a flow or transfer.</p>
<ol type="1">
<li>Time-wise validation</li>
</ol>
<p>Many healthcare model applications have in nature a time dimension, as data are collected by healthcare events that happen across time. There could be a trend in the data as people age, population structure changes, and the healthcare technologies/systems evolve. &gt; To better estimate the future performance of a model, a time-wise splitting and validating approach can be taken. This method sets data of a specified period along time as the testing set and uses the data before the testing set as training data. A visualisation of performance change over time will be obtained after a number of iterations, which provides an estimation of the trend of the model’s performance change in the near future - will it be relatively stable, gradually decreasing or increasing.</p>
<p>Some models have complex hyperparameter space and require an additional split of data for early stop in training or additional hyperparameter optimisation. In classification models that rely on a cut-off threshold in application (e.g.&nbsp;a high risk patient identification model based on numeric risk scores), the cut-off threshold can also be seen as part of the model hyperparameters, and its determination should be considered as part of the model development. Hence the performance validation process should be using a partition of data that is not used in either model training, additional hyperparameter optimisation, or the threshold optimisation in particular.</p>
<p>In all cases, care should be taken to ensure that the sampling unit is complete. For instance, we may be modelling a flow of events, in which case the sampling unit is likely to be a patient. If the modelled data consists of multiple records per patient, it will be important to ensure that complete patient records are sampled.</p>
</section>
<section id="performance-metrics" class="level3" data-number="8.6.2">
<h3 data-number="8.6.2" class="anchored" data-anchor-id="performance-metrics"><span class="header-section-number">8.6.2</span> Performance metrics</h3>
<p>The type of performance metric used will depend on the model being evaluated and the context of the project. For models that predict a value, such as a linear regression model, R-squared and root mean square error (RMSE) are common.</p>
<p>In health, metrics calculated from a confusion matrix for models that output a class (e.g.&nbsp;a decision tree) or probability (e.g.&nbsp;logistic regression) are commonly used. To produce a confusion matrix for a model that outputs a probability, a probability threshold is applied (values above the threshold are positive and values below are negative). The probability threshold can be set to optimise a particular metric, can be set by other optimisation techniques, or otherwise set according to the use case. Seek clinical input on the appropriate thresholds as they can impact patient care.</p>
<p>Common performance metrics used can include the following. Note that not all are appropriate for each model or data type or question being answered.</p>
<ul>
<li><p><strong>Precision</strong> quantifies the proportion of positive class predictions that actually belong to the positive class.</p></li>
<li><p><strong>Recall</strong> quantifies the number of positive class predictions made out of all positive examples in the dataset.</p></li>
<li><p><strong>Model accuracy</strong> is a machine learning classification model performance metric that is defined as the ratio of true positives and true negatives to all positive and negative observations.</p></li>
<li><p><strong>F-Measure</strong> provides a single score that balances both the concerns of precision and recall in one number.</p></li>
<li><p><strong>Positive and negative predictive values</strong> (PPV and NPV respectively) are the proportions of positive and negative results in statistics and diagnostic tests that are true positive and true negative results, respectively. The PPV and NPV describe the performance of a diagnostic test or other statistical measure.</p>
<ul>
<li>Positive predictive value (PPV) and negative predictive value (NPV) are best thought of as the clinical relevance of a test</li>
</ul></li>
<li><p><strong>Prevalence</strong> is the number of cases in a defined population at a single point in time and is expressed as a decimal or a percentage.</p></li>
<li><p><strong>Sensitivity</strong> is the percentage of true positives (e.g.&nbsp;90% sensitivity = 90% of people who <u>have</u> the target disease will test positive).</p></li>
<li><p><strong>Specificity</strong> is the percentage of true negatives (e.g.&nbsp;90% specificity = 90% of people who <u>do not have</u> the target disease will test negative).</p></li>
<li><p><strong>AUROC</strong> is <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3673738/">a performance metric for “discrimination”</a>: it tells you about the model’s ability to discriminate between cases (positive examples) and non-cases (negative examples.) For a ranking use case AUC-ROC is a measure that indicates how good the model is at ranking cases based on a score (how likely any two cases are correctly ordered). 0.5 indicates that the model is no better than random at ranking and 1 indicates a perfect model.</p></li>
<li><p><strong>AUC-PRC</strong> is a measure that indicates how good the model is at minimising the tradeoff between precision and recall. A high AUC-PRC represents the model can achieve high recall and high precision at the same time.</p></li>
</ul>
</section>
</section>
<section id="further-resources" class="level2" data-number="8.7">
<h2 data-number="8.7" class="anchored" data-anchor-id="further-resources"><span class="header-section-number">8.7</span> Further resources</h2>
<p><a href="https://developers.google.com/machine-learning/guides/rules-of-ml#overview">Rules of Machine Learning: Best Practices for ML Engineering</a> (Google Machine Learning Guides)</p>
<p>Erdemir, A., Mulugeta, L., Ku, J.P. <em>et al.</em> <a href="https://translational-medicine.biomedcentral.com/articles/10.1186/s12967-020-02540-4">Credible practice of modeling and simulation in healthcare: ten rules from a multidisciplinary perspective.</a> <em>J Transl Med</em> 18, 369 (2020). <a href="https://doi.org/10.1186/s12967-020-02540-4">https://doi.org/10.1186/s12967-020-02540-4</a></p>
<p>W. Hare, A. R. Rutherford, K. Vasarhelyi and The Complex Systems Modelling Group: Modelling in Healthcare, American Mathematical Society (2010)</p>
<p><a href="https://eugeneyan.com/writing/practical-guide-to-maintaining-machine-learning/">A Practical Guide to Maintaining Machine Learning in Production</a></p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
    var links = window.document.querySelectorAll('a:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
          // default icon
          link.classList.add("external");
      }
    }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./07-data-preparation.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Data preparation</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./09-evaluation.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Evaluation</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>