<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Health Data Science in Aotearoa New Zealand: A Practical Guide - 10&nbsp; Deployment &amp; lifecycle maintenance</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./references.html" rel="next">
<link href="./evaluation.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


</head>

<body class="nav-sidebar floating nav-fixed slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="./index.html" class="navbar-brand navbar-brand-logo">
    <img src="./img/logo-pdh.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Health Data Science in Aotearoa New Zealand: A Practical Guide</span>
    </a>
  </div>
          <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Deployment &amp; lifecycle maintenance</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="./index.html" class="sidebar-logo-link">
      <img src="./img/noun-mandatory-1951351.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Welcome</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./starting.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">How do I start?</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./basics.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Understanding the basics</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./collaboration.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">People, capability &amp; collaboration</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-landscape.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">The unique health data landscape</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-access.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Accessing and managing data</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-identifiability.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Data identifiability</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-preparation.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Data preparation</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./modelling.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Modelling</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./evaluation.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Evaluation</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./deployment-lifecycle.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Deployment &amp; lifecycle maintenance</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">References</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./glossary.html" class="sidebar-item-text sidebar-link">Glossary</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#sec-deployment" id="toc-sec-deployment" class="nav-link active" data-scroll-target="#sec-deployment"><span class="toc-section-number">10.1</span>  Operational deployment</a></li>
  <li><a href="#lifecycle-model-maintenance" id="toc-lifecycle-model-maintenance" class="nav-link" data-scroll-target="#lifecycle-model-maintenance"><span class="toc-section-number">10.2</span>  Lifecycle model maintenance</a>
  <ul class="collapse">
  <li><a href="#model-refreshment" id="toc-model-refreshment" class="nav-link" data-scroll-target="#model-refreshment"><span class="toc-section-number">10.2.1</span>  Model refreshment</a></li>
  <li><a href="#model-monitoring" id="toc-model-monitoring" class="nav-link" data-scroll-target="#model-monitoring"><span class="toc-section-number">10.2.2</span>  Model monitoring</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/precisiondrivenhealth/guide.git/edit/main/deployment-lifecycle.qmd" class="toc-action">Edit this page</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Deployment &amp; lifecycle maintenance</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="sec-deployment" class="level2" data-number="10.1">
<h2 data-number="10.1" class="anchored" data-anchor-id="sec-deployment"><span class="header-section-number">10.1</span> Operational deployment</h2>
<p>Health data science projects often aim to produce tools that are intended to be used in decision support - through presenting insights or suggestions. Thinking through the implications of the intended use in practice is critical to success.</p>
<p>We recommend planning for this from the start if operational deployment is an explicit goal as there is a big difference between research and operationalising something. Engage early with SMEs to gain the right mix of expertise for a successful implementation.</p>
<p>Some questions worth considering include:</p>
<ul>
<li><p>Who are the users, and what knowledge/capability/training will they need?</p></li>
<li><p>Is all the relevant data available at the point it is intended to be used, and is it current?</p></li>
<li><p>Is it feasible to get operational data supply ongoing to support this?</p></li>
<li><p>How will models/decisions/insights be presented to the user? Can users understand how the model came to a conclusion and what action is required? See section on <strong>Transparency and Interpretability</strong></p></li>
<li><p>What monitoring, IT security and safeguards are likely to be necessary?</p></li>
<li><p>What systems will be utilised, and who is responsible for them?</p></li>
<li><p>Who will provide governance oversight of the model?</p></li>
<li><p>Will the model be updated when new data becomes available?</p></li>
<li><p>What exactly is expected to be deployed? An API? A frontend?</p></li>
<li><p>How are the models and API going to be versioned?</p></li>
<li><p>How much traffic are you expecting?</p></li>
<li><p>How much response time and performance in time is acceptable ?</p></li>
<li><p>What level of work is required from warehouse developers when developing models? - a simple model is more likely to be implemented than one which is complicated even if there is a performance decrease.</p></li>
</ul>
<p>The below list outlines ideas and recommendations concerning operational deployment of ML solutions within the medical sector:</p>
<ul>
<li><p>Draw clear lines between research, analytics and software development. If you are looking to offer software as a service, then you need software engineers who are familiar with software development practices (e.g.&nbsp;writing production-grade code, developing infrastructure) that are necessary to succeed.</p></li>
<li><p>Keep things simple: most prospective customers in the medical sector are conservative and they need to understand (at least to some extent) solutions that are being offered to them and they are also most probably using outdated solutions (as opposed to cutting edge research)</p></li>
<li><p>Many prospective customers in the medical sector are going to be unwilling to send their data to an API over the public internet. You may either need to specifically focus on the niche of customers who do not have these constraints or you need to develop solutions that can be deployed on premise. This has profound implications on your architectural decisions (e.g.&nbsp;federated learning), your ability to provide maintenance and support as well as your ability to keep tight control over your source code</p></li>
<li><p>Identifiable health data is regulated around the world and you need to ensure that you follow the right security practices for your clients to be able to use your services. This also has downstream implications on debugging, logging, performance tracking, etc</p></li>
<li><p>Much of the publicly available health data that can be used to train models that you may wish to deploy in production have licences that forbid commercial usage – make sure you check these constraints before committing to a project</p></li>
<li><p>If you are offering ML models to external clients and your models leverage open source data, then you will find that you don’t need to regularly retrain these models since you’ll most likely be using a static snapshot for a one-off training exercise. This simplifies model management</p></li>
<li><p>For IT implementation at partner/clinical sites, typically design, governance, and security sign-off will be required before people can be allocated to the work. This requires clear articulation of the benefits of the work in order to be prioritised. Ensure there is strong clinical engagement from the partner site to drive this see <strong>End-user Engagement and collaboration</strong></p></li>
<li><p>Also refer to the <a href="https://www.health.govt.nz/our-work/digital-health/vision-health-technology/emerging-health-technology-advice-and-guidance">Ministry of Health - Emerging Health Technology Advice &amp; Guidance</a> on operationalising algorithms</p></li>
</ul>
</section>
<section id="lifecycle-model-maintenance" class="level2 page-columns page-full" data-number="10.2">
<h2 data-number="10.2" class="anchored" data-anchor-id="lifecycle-model-maintenance"><span class="header-section-number">10.2</span> Lifecycle model maintenance</h2>
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><a href="https://www.datascience-pm.com/crisp-dm-2/"><img src="./img/CRISP-DM.png" class="img-fluid figure-img" alt="The CRISP-DM Data Science Lifecycle"></a></p>
<p></p><figcaption class="figure-caption margin-caption">The CRISP-DM Data Science Lifecycle</figcaption><p></p>
</figure>
</div>
<p>Shearer, C. (2000). The CRISP-DM model: the new blueprint for data mining. <em>Journal of data warehousing</em>, <em>5</em>(4), 13-22.</p>
<p>Deployment of a model is never the end of modelling work. During its continuing life cycle, the model and its working environment need to be overseen continuously. Some early questions to consider are:</p>
<ul>
<li><p>What is the governance process?</p></li>
<li><p>Who is responsible for oversight and/or maintenance?</p></li>
<li><p>What is the process for monitoring model drift?</p></li>
<li><p>Is the model being used in the way it was originally intended according to the original use case?</p></li>
<li><p>Do the intended users of the model understand, trust and use the model outputs?</p></li>
</ul>
<p>In the case of “model drift” (non-negligible performance decrease is detected, or any condition for the model to properly work is no longer satisfied), the model and model application need to be reviewed, and in necessary cases the partial or whole modelling process should be reapplied to create a refreshed model.</p>
<p>Refer also to ’explaining the outputs, transparency &amp; interpretability</p>
<section id="model-refreshment" class="level3" data-number="10.2.1">
<h3 data-number="10.2.1" class="anchored" data-anchor-id="model-refreshment"><span class="header-section-number">10.2.1</span> Model refreshment</h3>
<p>There are two main approaches for triggering model refreshment:</p>
<ol type="1">
<li><p><strong>Time based refreshment.</strong> Retrain the model (regardless of the performance) at a regular interval. Better quality data, more current data, data with better population coverage or new data sources may become available over time meaning that a model trained on updated data would likely have significant performance improvements over the existing model. A good understanding of how frequently the data changes is needed for this approach.</p></li>
<li><p><strong>Performance based refreshment.</strong> Continuously monitor a set of the model performance metrics (and/or other metrics such as bias) to determine when the model needs a retraining. A good selection of the panel of metrics and thresholds is needed for this approach.</p></li>
</ol>
<p>But there are other considerations for model refreshment including:</p>
<ul>
<li><p><strong>Any change in how the model is being used.</strong> Are the users of the model still using it according to the original use case? If the model is being used for a different purpose, is it appropriate for that purpose?</p></li>
<li><p><strong>Potential for increased scrutiny of the model.</strong> You don’t want your model to be viewed negatively publicly and should consider how use of the model would look on the front page of the newspaper, particularly if there have been shifts in the inputs, in the outcomes, in the environment (e.g.&nbsp;new disease variants) or in attitudes that affect social licence.</p></li>
</ul>
</section>
<section id="model-monitoring" class="level3" data-number="10.2.2">
<h3 data-number="10.2.2" class="anchored" data-anchor-id="model-monitoring"><span class="header-section-number">10.2.2</span> Model monitoring</h3>
<p>Key areas to be monitored during model use include:</p>
<ol type="1">
<li><p><strong>The data feed.</strong> Are there any changes in the statistical properties of the data that are fed into the model, and the actual data labels or patient outcomes (there will be a lag to collect these) that the model predicts? Are they still similar to the data that the model was trained on? Has a “concept drift” detector been set up in the monitoring process? How is the bias in the data changing?</p></li>
<li><p><strong>The model performance metrics and bias metrics.</strong> Is there any significant drop in the model performance or model fairness and what are the possible reasons to be taken into account for retraining? This could be when a given metric, such as accuracy or combination of metrics, such a sensitivity and specificity have dropped below a certain threshold, or there is a clear downward trend in those metrics.</p></li>
<li><p><strong>The key assumptions that the modelling was based on.</strong> For example, in the COVID pandemic modelling work, is the current dominating virus variant still the same as the one when the modelling data were collected?</p></li>
<li><p><strong>The workflow where the model is integrated.</strong> Are there any changes in the upstream or downstream steps of the workflow that may make the model not applicable any more?</p></li>
<li><p><strong>The risk, benefit and cost of model usage</strong>. Does the benefit outweigh the risk in real use? Is the model use case as cost-effective as it was expected at design?</p></li>
</ol>
<p>More can be done besides the list above. For a more comprehensive model monitoring and retraining techniques, refer to <a href="https://eugeneyan.com/writing/practical-guide-to-maintaining-machine-learning/">this blog</a>: A Practical Guide to Maintaining Machine Learning in Production.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
    var links = window.document.querySelectorAll('a:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
          // default icon
          link.classList.add("external");
      }
    }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./evaluation.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Evaluation</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./references.html" class="pagination-link">
        <span class="nav-page-text">References</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>